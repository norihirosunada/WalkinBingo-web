<!DOCTYPE html>
<html lang="ja">
<head>
	<meta charset="UTF-8">
	<title>WalkinBingo</title>
</head>
<body class="text-center">
	<div class="scrollspy-example"
				data-bs-spy="scroll"
			  data-bs-target="#navbar"
			  data-bs-offset="0"
			  tabindex="0">
		<!--<div class="ratio ratio-1x1" id="bingoDiv"></div>-->
		<div class="bingo p-1 cover-container d-flex vw-100 vh-100 p-3 mx-auto flex-column bg-white text-dark" id="bingoDiv">
			<h1 class="float-md-start mb-3" id="resultText">Find!</h1>
			<div id="bingoCard">
				<div class="row ">
					<div class="col g-0 m-1">
						<div class="ratio ratio-1x1 border" id="box0">
						</div>
					</div>
					<div class="col g-0 m-1">
						<div class="ratio ratio-1x1 border" id="box1">
						</div>
					</div>
					<div class="col g-0 m-1">
						<div class="ratio ratio-1x1 border" id="box2">
						</div>
					</div>
				</div>
				<div class="row">
					<div class="col g-0 m-1">
						<div class="ratio ratio-1x1 border" id="box3">
						</div>
					</div>
					<div class="col g-0 m-1">
						<div class="ratio ratio-1x1 border" id="box4">
						</div>
					</div>
					<div class="col g-0 m-1">
						<div class="ratio ratio-1x1 border" id="box5">
						</div>
					</div>
				</div>
				<div class="row">
					<div class="col g-0 m-1">
						<div class="ratio ratio-1x1 border" id="box6">
						</div>
					</div>
					<div class="col g-0 m-1">
						<div class="ratio ratio-1x1 border" id="box7">
						</div>
					</div>
					<div class="col g-0 m-1">
						<div class="ratio ratio-1x1 border" id="box8">
						</div>
					</div>
				</div>
			</div>
			<div class="p-3 my-auto">
				<h2 class="" id="scoreText">Score: 0</h1>
				<a hidden href="" id="download"></a>
				<div class="row justify-content-end">
			    <div class="col-4">
			    	<a class="nav-link btn btn-outline-dark btn-lg" role="button" href="#cameraPage">
							<span class="material-symbols-outlined align-middle">image_search</span>
						</a>
			    </div>
			    <div class="col-4">
						<button type="button" class="btn btn-outline-dark btn-lg" id="shareButton">
							<span class="material-symbols-outlined align-middle">share</span>
						</button>
					</div>
			  </div>
			</div>
		</div>
		
		<div class="cameraPage cover-container d-flex vw-100 vh-100 mx-auto flex-column bg-dark text-white" id="cameraPage">
			<header class="p-3">
				<h1 class="float-md-start mb-3">Scan!</h1>
			</header>
			<div class="ratio ratio-1x1 w-100" id="cameraDiv"></div>
			<div class="p-3 my-auto">
				<h3 id="labelText"></h3>
				<div class="row justify-content-end">
			    <div class="col-4">
			      <button type="button" class="btn btn-outline-light btn-lg" id="shutterButton">
							<span class="material-symbols-outlined align-middle">circle</span>
						</button>
			    </div>
			    <div class="col-4">
						<button type="button" class="btn btn-outline-light btn-lg" id="flipButton">
							<span class="material-symbols-outlined align-middle">cameraswitch</span>
						</button>
			    </div>
			  </div>
			</div>
		</div>
	</div>

	<nav class="nav nav-pills nav-justified navbar fixed-bottom navbar-light bg-light text-dark" id="pills-tab" role="tablist">
		<a class="nav-link" href="#bingoDiv">
			<span class="material-symbols-outlined align-middle">task_alt</span>
		</a>
		<a class="nav-link" href="#cameraPage">
			<span class="material-symbols-outlined align-middle">image_search</span>
		</a>
	</nav>	

	<script src="/assets/js/sketch.js"></script>
	<script>
		$("#shareButton").on('click', function() {
			html2canvas(document.querySelector("#bingoCard"), {
				}).then(canvas => {
    		canvas.toBlob(blob => {
		      // $("#download").attr("download", `${document.title}.png`).attr("href", window.URL.createObjectURL(blob));
		      // $('a#download')[0].click();
		      const imageFile = new File([blob], "image.png", { type: "image/png", });
		      try {
				    await navigator.share({
					    text: "WalkinBingo",
					    // url: "",
					    files: [imageFile],
					  });
				    resultPara.textContent = 'MDN shared successfully'
				  } catch(err) {
				    resultPara.textContent = 'Error: ' + e
				  }
			  	// navigator.share({
				  //   text: "共有テスト",
				  //   url: "",
				  //   files: [imageFile],
				  // }).then(() => {
				  //   console.log("共有成功.");
				  // }).catch((error) => {
				  //   console.log(error);
				  // });
		  	});
    	});
		});
	</script>
</body>
</html>
